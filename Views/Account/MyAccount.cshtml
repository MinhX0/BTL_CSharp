@model backend.ViewModels.Account.MyAccountViewModel
@{
    ViewData["Title"] = "Tài khoản của tôi";
}

<div class="container pt-5 pb-5">
    <div class="row">
        <div class="col-md-3">
                <div class="nav flex-column nav-pills" role="tablist" aria-orientation="vertical">
                <a class="nav-link active" id="dashboard-nav" data-toggle="pill" href="#dashboard-tab" role="tab">Bảng điều khiển</a>
                <a class="nav-link" id="orders-nav" data-toggle="pill" href="#orders-tab" role="tab">Đơn hàng</a>
                <a class="nav-link" id="payment-nav" data-toggle="pill" href="#payment-tab" role="tab">Phương thức thanh toán</a>
                <a class="nav-link" id="address-nav" data-toggle="pill" href="#address-tab" role="tab">Địa chỉ</a>
                <a class="nav-link" id="account-nav" data-toggle="pill" href="#account-tab" role="tab">Thông tin tài khoản</a>
                <form method="post" asp-action="Logout">
                    <button type="submit" class="btn btn-link nav-link text-left">Đăng xuất</button>
                </form>
            </div>
        </div>
        <div class="col-md-9">
            <div class="tab-content">
                <div class="tab-pane fade show active" id="dashboard-tab" role="tabpanel" aria-labelledby="dashboard-nav">
                    <h4>Bảng điều khiển</h4>
                    <p>Chào mừng, <strong>@Model.FullName</strong> (@Model.Username)</p>
                    <p class="text-muted">Tại đây bạn có thể xem đơn hàng gần nhất, quản lý địa chỉ giao hàng và thanh toán, và thay đổi mật khẩu cùng thông tin tài khoản.</p>
                </div>
                <div class="tab-pane fade" id="orders-tab" role="tabpanel" aria-labelledby="orders-nav">
                    <h4>Đơn hàng của bạn</h4>
                    @if (Model.Orders == null || !Model.Orders.Any())
                    {
                        <p class="text-muted">Bạn chưa có đơn hàng nào.</p>
                    }
                    else
                    {
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Mã đơn hàng</th>
                                        <th>Ngày đặt</th>
                                        <th>Số sản phẩm</th>
                                        <th>Tổng tiền</th>
                                        <th>Trạng thái</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var order in Model.Orders)
                                    {
                                        <tr>
                                            <td>#@order.OrderId</td>
                                            <td>@order.OrderDate.ToString("dd/MM/yyyy HH:mm")</td>
                                            <td>@order.ItemCount sản phẩm</td>
                                            <td>@order.TotalAmount.ToString("N0", new System.Globalization.CultureInfo("vi-VN")) ₫</td>
                                            <td>
                                                @if (order.Status == "Pending")
                                                {
                                                    <span class="badge badge-warning">Đang xử lý</span>
                                                }
                                                else if (order.Status == "Processing")
                                                {
                                                    <span class="badge badge-info">Đang giao</span>
                                                }
                                                else if (order.Status == "Completed")
                                                {
                                                    <span class="badge badge-success">Hoàn thành</span>
                                                }
                                                else if (order.Status == "Cancelled")
                                                {
                                                    <span class="badge badge-danger">Đã hủy</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-secondary">@order.Status</span>
                                                }
                                            </td>
                                            <td>
                                                <a href="#" class="btn btn-sm btn-outline-primary">Xem chi tiết</a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                </div>
                <div class="tab-pane fade" id="payment-tab" role="tabpanel" aria-labelledby="payment-nav">
                    <h4>Phương thức thanh toán</h4>
                    <p class="text-muted">Chưa lưu phương thức thanh toán nào.</p>
                </div>
                <div class="tab-pane fade" id="address-tab" role="tabpanel" aria-labelledby="address-nav">
                    <h4>Địa chỉ</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Địa chỉ thanh toán</h5>
                            <p>@Model.Address</p>
                            <p>Mobile: @Model.Phone</p>
                        </div>
                        <div class="col-md-6">
                            <h5>Địa chỉ giao hàng</h5>
                            <p>@Model.Address</p>
                            <p>Mobile: @Model.Phone</p>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="account-tab" role="tabpanel" aria-labelledby="account-nav">
                    <h4>Thông tin tài khoản</h4>
                    <form method="post" asp-controller="Account" asp-action="UpdateAccount">
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <label>Họ và tên</label>
                                <input type="text" name="FullName" value="@Model.FullName" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Email</label>
                                <input type="text" name="Email" value="@Model.Email" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Điện thoại</label>
                                <input type="text" name="Phone" value="@Model.Phone" class="form-control" />
                            </div>
                            <div class="col-md-12 form-group">
                                <label>Địa chỉ</label>
                                <input type="text" name="Address" value="@Model.Address" class="form-control" />
                            </div>
                            <div class="col-md-12">
                                <button type="submit" class="btn btn-primary">Cập nhật</button>
                            </div>
                        </div>
                    </form>

                    <h4 class="mt-4">Thay đổi mật khẩu</h4>
                    <form method="post" asp-controller="Account" asp-action="ChangePassword">
                        <div class="row">
                            <div class="col-md-12 form-group">
                                <label>Mật khẩu hiện tại</label>
                                <input type="password" name="CurrentPassword" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Mật khẩu mới</label>
                                <input type="password" name="NewPassword" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Xác nhận mật khẩu</label>
                                <input type="password" name="ConfirmPassword" class="form-control" />
                            </div>
                            <div class="col-md-12">
                                <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
