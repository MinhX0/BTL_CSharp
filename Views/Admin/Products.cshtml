@model backend.ViewModels.Admin.ProductListViewModel
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewData["Title"] = "Sản phẩm";
    string FormatPrice(long value) => value.ToString("N0");
}
<div class="admin-card">
    <h3>Sản phẩm</h3>
    <div class="search-box">
        <form method="get" class="form-inline" style="width:100%;">
            <input type="text" name="search" value="@Model.SearchTerm" placeholder="Tìm sản phẩm..." />
            <button type="submit"><i class="fas fa-search"></i> Tìm</button>
            <a asp-controller="Admin" asp-action="CreateProduct" class="btn btn-sm btn-primary ml-2"><i class="fas fa-plus"></i> Tạo sản phẩm</a>
        </form>
    </div>
    <div class="admin-table">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Tên</th>
                    <th>Danh mục</th>
                    <th>Giá</th>
                    <th>Tồn kho</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
            @foreach (var p in Model.Products)
            {
                <tr>
                    <td>@p.ProductId</td>
                    <td>@p.Name</td>
                    <td>@p.CategoryName</td>
                    <td>@FormatPrice(p.Price)</td>
                    <td>@p.Stock</td>
                    <td>
                        <a asp-controller="Admin" asp-action="EditProduct" asp-route-id="@p.ProductId" class="btn-action btn-edit"><i class="fas fa-edit"></i></a>
                        <form asp-controller="Admin" asp-action="DeleteProduct" method="post" style="display:inline;" onsubmit="return confirm('Bạn có muốn xóa sản phẩm này?');">
                            <input type="hidden" name="id" value="@p.ProductId" />
                            <button type="submit" class="btn-action btn-delete"><i class="fas fa-trash"></i></button>
                        </form>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
    @if (Model.TotalCount > Model.PageSize)
    {
        <div class="pagination">
            @{
                var totalPages = (int)System.Math.Ceiling(Model.TotalCount / (double)Model.PageSize);
            }
            @for (int i = 1; i <= totalPages; i++)
            {
                if (i == Model.PageIndex)
                {
                    <span class="active">@i</span>
                }
                else
                {
                    <a asp-controller="Admin" asp-action="Products" asp-route-page="@i" asp-route-search="@Model.SearchTerm">@i</a>
                }
            }
        </div>
    }
</div>
